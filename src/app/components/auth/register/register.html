<section class="auth-card">
  <h2>Crear cuenta</h2>

  <!-- ğŸ”„ Banner de espera de verificaciÃ³n -->
  <div class="waiting-verification" *ngIf="waitingForVerification() && !loading()" role="status">
    <div class="spinner-small"></div>
    <div class="waiting-content">
      <strong>Esperando verificaciÃ³n de email...</strong>
      <p>Hemos enviado un email a tu direcciÃ³n. Haz clic en el enlace para verificar tu cuenta y acceder automÃ¡ticamente.</p>

      <!-- BotÃ³n de reenvÃ­o con temporizador -->
      <div class="resend-section">
        <button
          type="button"
          class="btn-resend"
          (click)="resendVerificationEmail()"
          [disabled]="!canResend() || resendingEmail()">
          <span *ngIf="resendingEmail()">â³ Enviando...</span>
          <span *ngIf="!resendingEmail() && !canResend()">ğŸ“§ Reenviar email ({{ resendCooldown() }}s)</span>
          <span *ngIf="!resendingEmail() && canResend()">ğŸ“§ Reenviar email</span>
        </button>
      </div>
    </div>
  </div>

  <!-- âœ… Banner de Ã©xito de registro -->
  <div class="success-message" *ngIf="registrationSuccess() && needsEmailVerification()" role="alert">
    <div class="success-icon">âœ“</div>
    <div class="success-content">
      <strong>Â¡Cuenta creada exitosamente!</strong>
      <p>Por favor, verifica tu email para continuar.</p>
    </div>
  </div>

  <form [formGroup]="form" (ngSubmit)="submit()" class="form">
    <label class="label">
      <span>Email</span>
      <input class="input" type="email" formControlName="email" autocomplete="username" />
    </label>
    <label class="label">
      <span>Usuario (opcional)</span>
      <input class="input" type="text" formControlName="username" />
    </label>
    <label class="label">
      <span>ContraseÃ±a</span>
      <input class="input" type="password" formControlName="password" autocomplete="new-password" />
    </label>

    <div class="actions">
      <button class="btn btn-primary" type="submit" [disabled]="loading()">
        {{ loading() ? 'Registrando...' : 'Registrarme' }}
      </button>
    </div>

    <div class="error" *ngIf="error() && !needsEmailVerification()">{{ error() }}</div>
  </form>
</section>