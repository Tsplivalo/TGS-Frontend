<div class="home">
  <div class="layout" [class.logged-in]="isLoggedIn() && !showAuthPanel">
    <!-- IZQUIERDA: Panel Auth -->
    <section *ngIf="showAuthPanel" class="auth-panel glass" [class.mode-login]="mode==='login'"
      [class.mode-register]="mode==='register'" [class.hiding]="hiding" [class.enter]="entering"
      [style.--split]="mode==='login' ? '64%' : '36%'">
      <div class="auth-body">
        <!-- LOGIN -->
        <div class="auth-half left" [class.active]="mode==='login'" (click)="setMode('login')" role="button"
          tabindex="0">
          <form class="auth-form" [formGroup]="loginForm" (ngSubmit)="submitLogin()" (click)="$event.stopPropagation()">
            <h2>Iniciar sesi√≥n</h2>

            <label>
              <span>Email</span>
              <input type="email" formControlName="email" placeholder="tu@email.com" autocomplete="email" required />
            </label>

            <label>
              <span>Contrase√±a</span>
              <input type="password" formControlName="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="current-password"
                required />
            </label>

            <button type="submit" [disabled]="loadingLogin">Entrar</button>
            <p class="auth-error" *ngIf="errorLogin">{{ errorLogin }}</p>
          </form>
        </div>

        <!-- Divisi√≥n -->
        <div class="auth-divider" aria-hidden="true"></div>

        <!-- REGISTRO -->
        <div class="auth-half right" [class.active]="mode==='register'" (click)="setMode('register')" role="button"
          tabindex="0">
          <form class="auth-form" [formGroup]="registerForm" (ngSubmit)="submitRegister()"
            (click)="$event.stopPropagation()">
            <h2>Crear cuenta</h2>

            <label>
              <span>Usuario</span>
              <input type="text" formControlName="username" placeholder="Tu nombre" autocomplete="username" required />
            </label>

            <label>
              <span>Email</span>
              <input type="email" formControlName="email" placeholder="tu@email.com" autocomplete="email" required />
            </label>

            <label>
              <span>Contrase√±a</span>
              <input type="password" formControlName="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="new-password"
                required />
            </label>

            <button type="submit" [disabled]="loadingRegister">Crear cuenta</button>
            <p class="auth-error" *ngIf="errorRegister">{{ errorRegister }}</p>
          </form>
        </div>
      </div>
    </section>

    <!-- DERECHA: Branding -->
    <section class="brand-plain" [class.is-logged]="isLoggedIn() && !showAuthPanel">
      <div class="welcome-badge" *ngIf="isLoggedIn() && !showAuthPanel">
        <span class="wave" aria-hidden="true">üëã</span>
        <span>Bienvenido/a, <strong>{{ user()?.username || 'usuario' }}</strong></span>
      </div>

      <div class="brand-head">
        <h1 class="wordmark">GarrSYS</h1>

        <img *ngIf="logoOk" class="logo" src="/logo-dark.svg" alt="GarrSYS" (error)="onLogoError()" />
        <span *ngIf="!logoOk" class="logo-fallback" aria-hidden="true">GS</span>
      </div>

      <p class="tagline">La plataforma que lleva tu negocio al siguiente nivel</p>
    </section>
  </div>

  <!-- INTRODUCCI√ìN con CARDS EXPANDIBLES (cuadrado azul + chevron) -->
  <section class="intro-v2" aria-labelledby="intro-title">
    <div class="intro-shell">
      <div class="intro-header">
        <span class="pill">GarrSYS en pocas palabras</span>
        <h3 id="intro-title">Todo en un mismo lugar</h3>
        <p class="lead">
          Centraliz√° productos, clientes, ventas y zonas con una interfaz clara. Menos pasos, menos fricci√≥n y m√°s foco
          en lo importante: tu negocio.
        </p>
      </div>

      <div class="intro-grid">
        <button class="intro-card" type="button" *ngFor="let it of introItems; let i = index"
          (click)="toggleFlip(i, $event)" (keydown)="onCardKey(i, $event)" [class.expanded]="flipped.has(i)"
          [attr.aria-expanded]="flipped.has(i) ? 'true' : 'false'" [attr.aria-label]="it.title">
          <div class="card-surface">
            <header class="card-head">
              <span class="tiny-logo" aria-hidden="true"></span>
              <h4 class="card-title">{{ it.title }}</h4>
              <span class="chev" aria-hidden="true"></span>
            </header>

            <div class="card-detail">
              <p class="detail">{{ it.detail }}</p>
            </div>
          </div>
        </button>
      </div>

      <div class="intro-steps" aria-labelledby="steps-title">
        <h5 id="steps-title">C√≥mo empezar</h5>
        <ol>
          <li>Cre√° tu cuenta o inici√° sesi√≥n.</li>
          <li>Carg√° productos y clientes.</li>
          <li>Activ√° tus flujos de venta y gesti√≥n.</li>
        </ol>
      </div>
    </div>
  </section>
</div>